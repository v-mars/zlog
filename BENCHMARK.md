# zlog 性能测试报告

## 测试概述

本报告比较了 zlog 与主流 Go 日志库（zerolog、logrus、zap）的性能表现。测试使用 100,000 次日志写入操作，并进行了多次运行以确保结果的准确性。

## 测试配置

- **测试次数**: 100,000 次日志写入操作
- **测试环境**: macOS, Apple Silicon
- **日志内容**: 结构化日志消息，包含 ID、状态、用户信息
- **输出**: JSON 格式和 Console 格式

## 性能测试结果

| 日志库 | 平均耗时 | 每次操作耗时 | 相对性能 |
|--------|----------|-------------|----------|
| zerolog | 240.00 ms | 2,406 ns/op | 1.00x (最快) |
| zlog (JSON) | 342.00 ms | 3,423 ns/op | 1.42x |
| logrus | 449.00 ms | 4,497 ns/op | 1.87x |
| zap | 402.00 ms | 4,026 ns/op | 1.68x |
| zlog (Console) | 1009.00 ms | 10,090 ns/op | 4.20x |

## 详细分析

### 1. zlog 性能特点

- **zlog (JSON)**: 性能表现优异，比 logrus 快约 30%，比 zap 快约 15%
- **zlog (Console)**: 由于格式化开销，性能较慢，但仍能满足大多数应用场景
- **总体**: zlog 在性能和功能之间取得了良好平衡

### 2. 与竞争库的比较

#### zlog vs zerolog
- zlog 构建于 zerolog 之上，性能接近原生 zerolog（仅慢 42%）
- 提供了更多高级功能（如 Hertz 集成、OTel 支持、轮转等）

#### zlog vs logrus
- zlog JSON 格式比 logrus 快约 30%
- zlog 具备更现代的架构和 API

#### zlog vs zap
- zlog JSON 格式比 zap 快约 15%
- zlog API 更加简洁易用

### 3. 特性对比

| 特性 | zlog | zerolog | logrus | zap |
|------|------|---------|--------|-----|
| 性能 | 高 | 最高 | 较低 | 中等 |
| API 简洁度 | 优秀 | 优秀 | 良好 | 复杂 |
| JSON 支持 | 内置 | 内置 | 内置 | 内置 |
| Console 格式 | ✓ | 需配置 | 需配置 | 需配置 |
| 轮转支持 | ✓ (集成) | 需第三方 | 需第三方 | 需第三方 |
| OTel 集成 | ✓ | 需配置 | 需配置 | 需配置 |
| Hertz 集成 | ✓ | 无 | 无 | 无 |
| 调用者信息 | ✓ | ✓ | 需配置 | ✓ |

## 总结

1. **性能优势**: zlog 的 JSON 格式性能优于 logrus 和 zap，接近底层的 zerolog
2. **功能丰富**: 提供了业界领先的特性集，包括 Hertz 集成和 OpenTelemetry 支持
3. **易于使用**: API 设计简洁，Option 模式提供高度可配置性
4. **适用场景**:
   - JSON 格式适用于生产环境日志收集
   - Console 格式适用于开发环境调试
   - 集成特性适用于微服务架构

## 推荐使用场景

- **生产环境**: 使用 `zlog.JSONFormat` 获取最佳性能
- **开发环境**: 使用 `zlog.ConsoleFormat` 获得可读性
- **云原生应用**: 利用 OTel 集成进行分布式追踪
- **Hertz 框架**: 直接使用 Hertz 适配器